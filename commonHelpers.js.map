{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\naxios.defaults.headers.common['x-api-key'] =\n  '44179146-9b08b79ddd3beefa939deb5d3';\naxios.defaults.headers = ['Access-Control-Allow-Origin'];\nconst API_KEY = '44179146-9b08b79ddd3beefa939deb5d3';\nconst baseURL = `https://pixabay.com/api/`;\nlet page = 1;\nlet searchQuery = '';\nlet img_on_page = 100;\nlet maximum;\nlet canScroll = true;\n\ndocument.addEventListener('DOMContentLoaded', () => {\n  const more = document.querySelector('.load-more');\n  const form = document.getElementById('search-form');\n  const gallery = document.querySelector('.gallery');\n\n  const lightbox = new SimpleLightbox('.gallery a', {\n    captionsData: 'alt',\n    captionDelay: 250,\n  });\n\n  form.addEventListener('submit', async event => {\n    event.preventDefault();\n    more.style.display = 'none';\n    gallery.innerHTML = '';\n    page = 1;\n    searchQuery = event.target.searchQuery.value.trim();\n    if (!searchQuery) {\n      iziToast.error({\n        title: 'Error',\n        message: 'Please enter a search query.',\n      });\n      return;\n    }\n    requestImages();\n  });\n\n  function displayImages(images) {\n    gallery.innerHTML += images\n      .map(\n        image => `\n          <div class=\"image-card\">\n            <a href=\"${image.largeImageURL}\" class=\"gallery_link\">\n              <img class=\"image\" src=\"${image.webformatURL}\" alt=\"${image.tags}\" loading=\"lazy\" />\n              <div class=\"image-attributes\">\n                <div class=\"item\">\n                  <p>Likes: </p>\n                  <p> ${image.likes}</p>\n                </div>\n                <div class=\"item\">\n                  <p>Views: </p>\n                  <p> ${image.views}</p>\n                </div>\n                <div class=\"item\">\n                  <p>Comments: </p>\n                  <p> ${image.comments}</p>\n                </div>\n                <div class=\"item\">\n                  <p>Downloads:</p>\n                  <p> ${image.downloads}</p>\n                </div>\n              </div>\n            </a>\n          </div>\n      `\n      )\n      .join('');\n\n    more.style.display = 'block';\n    lightbox.refresh();\n\n    const { height: cardHeight } = document\n      .querySelector('.gallery')\n      .firstElementChild.getBoundingClientRect();\n\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n  }\n\n  async function requestImages() {\n    try {\n      const response = await axios.get(baseURL, {\n        params: {\n          key: API_KEY,\n          q: searchQuery,\n          image_type: 'photo',\n          orientation: 'horizontal',\n          safesearch: true,\n          per_page: img_on_page,\n          page,\n        },\n      });\n\n      const images = response.data.hits;\n      maximum = response.data.totalHits;\n\n      if (images.length === 0) {\n        iziToast.warning({\n          title: 'No Results',\n          message:\n            'Sorry, there are no images matching your search query. Please try again.',\n        });\n        gallery.innerHTML = '';\n        return;\n      }\n      if (page === 1) {\n        iziToast.success({\n          title: 'Success',\n          message: `Hooray! We found ${response.data.totalHits} images.`,\n          position: 'topCenter',\n        });\n      }\n\n      displayImages(images);\n      page++;\n      canScroll = checkNextPage(response.data.totalHits);\n    } catch (error) {\n      iziToast.error({\n        title: 'Error',\n        message: 'Something went wrong. Please try again later.',\n      });\n    }\n  }\n\n  more.addEventListener('click', () => {\n    requestImages();\n  });\n\n  function checkNextPage(maximum) {\n    if (maximum < gallery.children.length + img_on_page) {\n      more.style.display = 'none';\n      iziToast.info({\n        title: 'Limit',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n      return false;\n    }\n    return true;\n  }\n\n  // infinite scrool\n\n  // const scroll_listener = window.addEventListener('scroll', () => {\n  //   if (!canScroll) {\n  //     window.removeEventListener(scroll_listener);\n  //   }\n  //   if (\n  //     window.innerHeight + window.scrollY >= document.body.offsetHeight - 50 &&\n  //     searchQuery.length > 0 &&\n  //     checkNextPage(maximum) &&\n  //     maximum >= page * img_on_page\n  //   ) {\n  //     requestImages();\n  //     console.log(page);\n  //   }\n  // });\n});\n"],"names":["axios","API_KEY","baseURL","page","searchQuery","img_on_page","maximum","canScroll","more","form","gallery","lightbox","SimpleLightbox","event","iziToast","requestImages","displayImages","images","image","cardHeight","response","checkNextPage"],"mappings":"owBAMAA,EAAM,SAAS,QAAQ,OAAO,WAAW,EACvC,qCACFA,EAAM,SAAS,QAAU,CAAC,6BAA6B,EACvD,MAAMC,EAAU,qCACVC,EAAU,2BAChB,IAAIC,EAAO,EACPC,EAAc,GACdC,EAAc,IACdC,EACAC,EAAY,GAEhB,SAAS,iBAAiB,mBAAoB,IAAM,CAClD,MAAMC,EAAO,SAAS,cAAc,YAAY,EAC1CC,EAAO,SAAS,eAAe,aAAa,EAC5CC,EAAU,SAAS,cAAc,UAAU,EAE3CC,EAAW,IAAIC,EAAe,aAAc,CAChD,aAAc,MACd,aAAc,GAClB,CAAG,EAEDH,EAAK,iBAAiB,SAAU,MAAMI,GAAS,CAM7C,GALAA,EAAM,eAAc,EACpBL,EAAK,MAAM,QAAU,OACrBE,EAAQ,UAAY,GACpBP,EAAO,EACPC,EAAcS,EAAM,OAAO,YAAY,MAAM,KAAI,EAC7C,CAACT,EAAa,CAChBU,EAAS,MAAM,CACb,MAAO,QACP,QAAS,8BACjB,CAAO,EACD,MACD,CACDC,GACJ,CAAG,EAED,SAASC,EAAcC,EAAQ,CAC7BP,EAAQ,WAAaO,EAClB,IACCC,GAAS;AAAA;AAAA,uBAEMA,EAAM,aAAa;AAAA,wCACFA,EAAM,YAAY,UAAUA,EAAM,IAAI;AAAA;AAAA;AAAA;AAAA,wBAItDA,EAAM,KAAK;AAAA;AAAA;AAAA;AAAA,wBAIXA,EAAM,KAAK;AAAA;AAAA;AAAA;AAAA,wBAIXA,EAAM,QAAQ;AAAA;AAAA;AAAA;AAAA,wBAIdA,EAAM,SAAS;AAAA;AAAA;AAAA;AAAA;AAAA,OAMhC,EACA,KAAK,EAAE,EAEVV,EAAK,MAAM,QAAU,QACrBG,EAAS,QAAO,EAEhB,KAAM,CAAE,OAAQQ,CAAU,EAAK,SAC5B,cAAc,UAAU,EACxB,kBAAkB,sBAAqB,EAE1C,OAAO,SAAS,CACd,IAAKA,EAAa,EAClB,SAAU,QAChB,CAAK,CACF,CAED,eAAeJ,GAAgB,CAC7B,GAAI,CACF,MAAMK,EAAW,MAAMpB,EAAM,IAAIE,EAAS,CACxC,OAAQ,CACN,IAAKD,EACL,EAAGG,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAUC,EACV,KAAAF,CACD,CACT,CAAO,EAEKc,EAASG,EAAS,KAAK,KAG7B,GAFAd,EAAUc,EAAS,KAAK,UAEpBH,EAAO,SAAW,EAAG,CACvBH,EAAS,QAAQ,CACf,MAAO,aACP,QACE,0EACZ,CAAS,EACDJ,EAAQ,UAAY,GACpB,MACD,CACGP,IAAS,GACXW,EAAS,QAAQ,CACf,MAAO,UACP,QAAS,oBAAoBM,EAAS,KAAK,SAAS,WACpD,SAAU,WACpB,CAAS,EAGHJ,EAAcC,CAAM,EACpBd,IACAI,EAAYc,EAAcD,EAAS,KAAK,SAAS,CAClD,MAAe,CACdN,EAAS,MAAM,CACb,MAAO,QACP,QAAS,+CACjB,CAAO,CACF,CACF,CAEDN,EAAK,iBAAiB,QAAS,IAAM,CACnCO,GACJ,CAAG,EAED,SAASM,EAAcf,EAAS,CAC9B,OAAIA,EAAUI,EAAQ,SAAS,OAASL,GACtCG,EAAK,MAAM,QAAU,OACrBM,EAAS,KAAK,CACZ,MAAO,QACP,QAAS,4DACjB,CAAO,EACM,IAEF,EACR,CAkBH,CAAC"}